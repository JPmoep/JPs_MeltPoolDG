# Listing of Parameters
# ---------------------
subsection adaptive meshing
  # Sets this parameter to true to activate adaptive meshing
  set do amr                    = false

  # Defines the (lower) percentage of elements that should be coarsened
  set lower perc to coarsen     = 0

  # Defines the number of maximum refinement steps one grid cell will be
  # undergone.
  set max grid refinement level = 12

  # Defines the (upper) percentage of elements that should be refined
  set upper perc to refine      = 0
end


subsection advection diffusion
  # Defines the diffusivity for the advection diffusion equation
  set advec diff diffusivity     = 0

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set advec diff do matrix free  = false

  # Defines if the l2norm of the advected field should be printed).
  set advec diff do print l2norm = true

  # Sets the end time for the solution of the advection diffusion problem
  set advec diff end time        = 1

  # Defines the start time for the solution of the levelset problem
  set advec diff start time      = 0

  # Sets the theta value for the time stepping scheme: 0=explicit euler;
  # 1=implicit euler; 0.5=Crank-Nicholson;
  set advec diff theta           = 0.5

  # Sets the step size for time stepping. For non-uniform time stepping, this
  # parameter determines the size of the first time step.
  set advec diff time step size  = 0.01
end


subsection base
  # Sets the base name for the application that will be fed to the problem
  # type.
  set application name   = rotating_bubble # default: none

  # Defines the interpolation degree
  set degree             = 1

  # Defines the dimension of the problem
  set dimension          = 2

  # Defines the number of initial global refinements
  set global refinements = 6               # default: 1

  # Defines the number of quadrature points
  set n q points 1d      = -1

  # Sets the base name for the problem that should be solved.
  set problem name       = level_set       # default: none
end


subsection curvature
  # curvature computation: damping = cell_size * curv_damping_scale_factor
  set curv damping scale factor = 0

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set curv do matrix free       = false

  # Defines if the l2norm of the curvature result should be printed)
  set curv do print l2norm      = true
end


subsection levelset
  # Defines the artificial diffusivity for the level set transport equation
  set ls artificial diffusivity = 0.0   # default: 0

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set ls do matrix free         = false

  # Defines if the l2norm of the levelset result should be printed)
  set ls do print l2norm        = true  # default: false

  # Defines if reinitialization of level set function is activated
  set ls do reinitialization    = true  # default: false

  # Enables to dynamically adapt the time step to meet the CFL condition in
  # case of explicit time integration (theta=0)
  set ls enable CFL condition   = false

  # Sets the end time for the solution of the levelset problem
  set ls end time               = 0.05  # default: 1

  # Defines the start time for the solution of the levelset problem
  set ls start time             = 0.0   # default: 0

  # Sets the theta value for the time stepping scheme (0=explicit euler;
  # 1=implicit euler; 0.5=Crank-Nicholson
  set ls theta                  = 0.5

  # Sets the step size for time stepping. For non-uniform time stepping, this
  # parameter determines the size of the first time step.
  set ls time step size         = 0.01
end


subsection normal vector
  # normal vector computation: damping = cell_size *
  # normal_vec_damping_scale_factor
  set normal vec damping scale factor = 0.5

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set normal vec do matrix free       = false

  # Defines if the l2norm of the normal vector result should be printed)
  set normal vec do print l2norm      = true
end


subsection output
  # this flag enables the computation of the error compared to a given
  # analytical solution.
  set do compute error         = false

  # boolean for computing the phase volumes
  set do compute volume output = false

  # this flag enables the output of wall times (should be disabled if a test
  # file is prepared)
  set do walltime              = false

  # Sets the base name for the volume fraction file output.
  set filename volume output   = my_volumes.txt
end


subsection paraview
  # boolean for writing the initial state into the paraview output file
  set paraview do initial state    = true

  # boolean for producing paraview output files
  set paraview do output           = false

  # Sets the base name for the paraview file output.
  set paraview filename            = solution

  # number of digits for the frame number of the vtk-file.
  set paraview n digits timestep   = 4

  # number of parallel written vtk-files.
  set paraview n groups            = 4

  # boolean for writing the computed advection into the paraview output file
  set paraview print advection     = false

  # boolean for printing a vtk-file with the boundary id
  set paraview print boundary id   = false

  # boolean for writing the computed curvature into the paraview output file
  set paraview print curvature     = false

  # boolean for writing the exact solution into the paraview output file
  set paraview print exactsolution = false

  # boolean for writing the levelset variable into the paraview output file
  set paraview print levelset      = true

  # boolean for writing the computed normalvector into the paraview output
  # file
  set paraview print normal vector = false

  # every n timestep that should be written
  set paraview write frequency     = 1
end


subsection reinitialization
  # Defines the length parameter of the level set function to be constant
  # andnot to dependent on the mesh size (default: -1.0 i.e. grid size
  # dependentwhich can be controlled by reinit_epsilon_scale_factor
  set reinit constant epsilon     = -1

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set reinit do matrix free       = false

  # Defines if the l2norm of the reinitialization result should be printed)
  set reinit do print l2norm      = true       # default: false

  # Defines the time step size of the reinitialization to be constant andnot
  # to dependent on the mesh size (default: -1.0 i.e. grid size dependent
  set reinit dtau                 = -1

  # Sets the maximum number of reinitialization steps
  set reinit max n steps          = 5

  # Sets the type of reinitialization model that should be used.
  set reinit modeltype            = olsson2007

  # Defines the scaling factor of the diffusion parameter in the
  # reinitialization equation; the scaling factor is multipled by the mesh
  # size (default: 0.5 i.e. eps=0.5*h_min
  set reinit scale factor epsilon = 0.5
end


| normal vector:         i=74 	|n_0| = 66.676541871   |n_1| = 67.433582258   
    | reini: τ= 0.015625  | CG: i=15   	 |ΔΨ|∞ = 0.5026334156    |ΔΨ|²/dT = 205.6335667    |
    | reini: τ= 0.03125   | CG: i=15   	 |ΔΨ|∞ = 0.2908769634    |ΔΨ|²/dT = 112.6372295    |
    | reini: τ= 0.046875  | CG: i=15   	 |ΔΨ|∞ = 0.152334047     |ΔΨ|²/dT = 57.32005499    |
    | reini: τ= 0.0625    | CG: i=15   	 |ΔΨ|∞ = 0.0747426334    |ΔΨ|²/dT = 28.63013349    |
    | reini: τ= 0.078125  | CG: i=15   	 |ΔΨ|∞ = 0.03659823533   |ΔΨ|²/dT = 14.61332635    |
| ls: t= 0.01      | GMRES: i=63   	 |Δϕ|2 = 64.34622011    
| normal vector:         i=76 	|n_0| = 64.774748548   |n_1| = 65.570096844   
    | reini: τ= 0.015625  | CG: i=16   	 |ΔΨ|∞ = 0.04044622021   |ΔΨ|²/dT = 13.68029926    |
    | reini: τ= 0.03125   | CG: i=15   	 |ΔΨ|∞ = 0.01984771614   |ΔΨ|²/dT = 7.054920339    |
    | reini: τ= 0.046875  | CG: i=16   	 |ΔΨ|∞ = 0.01400367261   |ΔΨ|²/dT = 3.982477456    |
    | reini: τ= 0.0625    | CG: i=16   	 |ΔΨ|∞ = 0.01044447895   |ΔΨ|²/dT = 2.486308383    |
    | reini: τ= 0.078125  | CG: i=16   	 |ΔΨ|∞ = 0.008151955214  |ΔΨ|²/dT = 1.720368035    |
| normal vector:         i=76 	|n_0| = 64.669086852   |n_1| = 65.467596124   
| curvature:         i=31 	|k| = 1581.8201028   
| ls: t= 0.02      | GMRES: i=63   	 |Δϕ|2 = 64.31631472    
| normal vector:         i=76 	|n_0| = 64.667701653   |n_1| = 65.451178558   
    | reini: τ= 0.015625  | CG: i=15   	 |ΔΨ|∞ = 0.0329460107    |ΔΨ|²/dT = 9.406049873    |
    | reini: τ= 0.03125   | CG: i=16   	 |ΔΨ|∞ = 0.01747367921   |ΔΨ|²/dT = 4.82109147     |
    | reini: τ= 0.046875  | CG: i=16   	 |ΔΨ|∞ = 0.01086051454   |ΔΨ|²/dT = 2.636247081    |
    | reini: τ= 0.0625    | CG: i=16   	 |ΔΨ|∞ = 0.007273291981  |ΔΨ|²/dT = 1.624510404    |
    | reini: τ= 0.078125  | CG: i=16   	 |ΔΨ|∞ = 0.005350769408  |ΔΨ|²/dT = 1.165240078    |
| normal vector:         i=76 	|n_0| = 64.655837922   |n_1| = 65.440250861   
| curvature:         i=31 	|k| = 1583.0647117   
| ls: t= 0.03      | GMRES: i=63   	 |Δϕ|2 = 64.31283038    
| normal vector:         i=76 	|n_0| = 64.653570888   |n_1| = 65.413533395   
    | reini: τ= 0.015625  | CG: i=15   	 |ΔΨ|∞ = 0.02919193183   |ΔΨ|²/dT = 8.79949705     |
    | reini: τ= 0.03125   | CG: i=15   	 |ΔΨ|∞ = 0.01601805721   |ΔΨ|²/dT = 4.498513635    |
    | reini: τ= 0.046875  | CG: i=16   	 |ΔΨ|∞ = 0.008514679163  |ΔΨ|²/dT = 2.395799683    |
    | reini: τ= 0.0625    | CG: i=16   	 |ΔΨ|∞ = 0.006292329312  |ΔΨ|²/dT = 1.40983938     |
    | reini: τ= 0.078125  | CG: i=16   	 |ΔΨ|∞ = 0.004803945343  |ΔΨ|²/dT = 0.9709525559   |
| normal vector:         i=76 	|n_0| = 64.652267345   |n_1| = 65.413051837   
| curvature:         i=31 	|k| = 1586.2334891   
| ls: t= 0.04      | GMRES: i=63   	 |Δϕ|2 = 64.31233948    
| normal vector:         i=76 	|n_0| = 64.649284697   |n_1| = 65.376892706   
    | reini: τ= 0.015625  | CG: i=15   	 |ΔΨ|∞ = 0.03238823773   |ΔΨ|²/dT = 8.835225771    |
    | reini: τ= 0.03125   | CG: i=15   	 |ΔΨ|∞ = 0.01652724403   |ΔΨ|²/dT = 4.38743876     |
    | reini: τ= 0.046875  | CG: i=15   	 |ΔΨ|∞ = 0.008895208204  |ΔΨ|²/dT = 2.240266092    |
    | reini: τ= 0.0625    | CG: i=16   	 |ΔΨ|∞ = 0.005284716334  |ΔΨ|²/dT = 1.223270183    |
    | reini: τ= 0.078125  | CG: i=16   	 |ΔΨ|∞ = 0.003542701352  |ΔΨ|²/dT = 0.7671948076   |
| normal vector:         i=76 	|n_0| = 64.648920251   |n_1| = 65.377649912   
| curvature:         i=31 	|k| = 1580.5365326   
| ls: t= 0.05      | GMRES: i=63   	 |Δϕ|2 = 64.31225789    
| normal vector:         i=76 	|n_0| = 64.64543988    |n_1| = 65.333183221   
    | reini: τ= 0.015625  | CG: i=15   	 |ΔΨ|∞ = 0.03080435662   |ΔΨ|²/dT = 8.815613933    |
    | reini: τ= 0.03125   | CG: i=15   	 |ΔΨ|∞ = 0.01338396973   |ΔΨ|²/dT = 4.361962708    |
    | reini: τ= 0.046875  | CG: i=15   	 |ΔΨ|∞ = 0.007615139507  |ΔΨ|²/dT = 2.183126011    |
    | reini: τ= 0.0625    | CG: i=15   	 |ΔΨ|∞ = 0.004495028236  |ΔΨ|²/dT = 1.13869479     |
    | reini: τ= 0.078125  | CG: i=16   	 |ΔΨ|∞ = 0.002767452941  |ΔΨ|²/dT = 0.661956322    |
| normal vector:         i=76 	|n_0| = 64.644880934   |n_1| = 65.334129766   
| curvature:         i=31 	|k| = 1581.431039    
