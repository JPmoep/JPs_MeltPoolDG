# Listing of Parameters
# ---------------------
subsection adaptive meshing
  # Sets this parameter to true to activate adaptive meshing
  set do amr                    = false

  # Defines the (lower) percentage of elements that should be coarsened
  set lower perc to coarsen     = 0

  # Defines the number of maximum refinement steps one grid cell will be
  # undergone.
  set max grid refinement level = 12

  # Defines the (upper) percentage of elements that should be refined
  set upper perc to refine      = 0
end


subsection advection diffusion
  # Defines the diffusivity for the advection diffusion equation
  set advec diff diffusivity             = 0

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set advec diff do matrix free          = false

  # Defines if the l2norm of the advected field should be printed).
  set advec diff do print l2norm         = true

  # Sets the end time for the solution of the advection diffusion problem
  set advec diff end time                = 1

  # Choose the corresponding implementation of the advection diffusion
  # operation.
  set advec diff implementation          = meltpooldg

  # Sets the maximum number of advection diffusion steps
  set advec diff max n steps             = 1000000

  # Defines the start time for the solution of the levelset problem
  set advec diff start time              = 0

  # Determines the time integration scheme.
  set advec diff time integration scheme = crank_nicolson

  # Sets the step size for time stepping. For non-uniform time stepping, this
  # parameter determines the size of the first time step.
  set advec diff time step size          = 0.01
end


subsection base
  # Sets the base name for the application that will be fed to the problem
  # type.
  set application name    = vortex_bubble # default: none

  # Defines the interpolation degree
  set degree              = 1

  # Defines the dimension of the problem
  set dimension           = 2

  # Sets this parameter to true to list parameters in output
  set do print parameters = true

  # Use simplices
  set do simplex          = false

  # Defines the number of initial global refinements
  set global refinements  = 5             # default: 1

  # Set the value for the gravity
  set gravity             = 0

  # Defines the number of quadrature points
  set n q points 1d       = -1

  # Sets the base name for the problem that should be solved.
  set problem name        = level_set     # default: advection_diffusion
end


subsection curvature
  # curvature computation: damping = cell_size * curv_damping_scale_factor
  set curv damping scale factor = 0

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set curv do matrix free       = false

  # Defines if the l2norm of the curvature result should be printed)
  set curv do print l2norm      = true

  # Choose the corresponding implementation of the curvature operation.
  set curv implementation       = meltpooldg
end


subsection flow
  # density of the flow field
  set flow density                                           = -1

  # density difference of the two-phase flow field
  set flow density difference                                = 0

  # Sets the end time for the solution of the levelset problem
  set flow end time                                          = 1

  # Sets the maximum number of flow steps
  set flow max n steps                                       = 1000000

  # number of 1d quadrature points for the velocity field of the flow
  set flow n q points 1d                                     = -1

  # solver type of the flow problem
  set flow solver type                                       = incompressible

  # Defines the start time for the solution of the levelset problem
  set flow start time                                        = 0

  # constant coefficient for calculating surface tension
  set flow surface tension coefficient                       = 0

  # Reference temperature for calculating surface tension
  set flow surface tension reference temperature             = 0

  # temperature dependent coefficient for calculating temperetaure-dependent
  # surface tension (Marangoni convection)
  set flow temperature dependent surface tension coefficient = 0

  # Sets the step size for time stepping. For non-uniform time stepping, this
  # parameter determines the size of the first time step.
  set flow time step size                                    = 0.05

  # velocity degree of the flow field
  set flow velocity degree                                   = -1

  # viscosity of the flow field
  set flow viscosity                                         = -1

  # viscosity difference of the two-phase flow field
  set flow viscosity difference                              = 0
end


subsection levelset
  # Defines the artificial diffusivity for the level set transport equation
  set ls artificial diffusivity  = 0.0            # default: 0

  # Set this parameter to true if in areas outside the interface region a
  # correction of the curvature values should be applied. This parameter can
  # be helpful to avoid numerical instabilities.
  set ls do curvature correction = false

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set ls do matrix free          = true           # default: false

  # Defines if the l2norm of the levelset result should be printed)
  set ls do print l2norm         = true           # default: false

  # Defines if reinitialization of level set function is activated
  set ls do reinitialization     = true           # default: false

  # Enables to dynamically adapt the time step to meet the CFL condition in
  # case of explicit time integration.
  set ls enable CFL condition    = false

  # Sets the end time for the solution of the levelset problem
  set ls end time                = 0.05           # default: 1

  # Choose the corresponding implementation of the ls operation.
  set ls implementation          = meltpooldg

  # Defines the start time for the solution of the levelset problem
  set ls start time              = 0.0            # default: 0

  # Determines the time integration scheme.
  set ls time integration scheme = crank_nicolson

  # Sets the step size for time stepping. For non-uniform time stepping, this
  # parameter determines the size of the first time step.
  set ls time step size          = 0.01
end


subsection melt pool
  # Ambient temperature in the inert gas.
  set mp ambient temperature                  = 0

  # Boiling temperature of the melt.
  set mp boiling temperature                  = 0

  # Set this parameter to true to move the laser in x-direction with the given
  # parameter scan speed (in case of an analytical temperature field).
  set mp do move laser                        = false

  # Defines if the l2norm of the melt pool results should be printed)
  set mp do print l2norm                      = true

  # maximum x coordinate of simulation domain
  set mp domain x max                         = 0

  # minimum x coordinate of simulation domain
  set mp domain x min                         = 0

  # maximum y coordinate of simulation domain
  set mp domain y max                         = 0

  # minimum y coordinate of simulation domain
  set mp domain y min                         = 0

  # Absorptivity of the gaseous part of domain
  set mp gas absorptivity                     = 0

  # Capacity of the gaseous part of domain
  set mp gas capacity                         = 0

  # Conductivity of the gaseous part of domain
  set mp gas conductivity                     = 0

  # Center coordinates of the laser beam on the interface melt/gas.
  set mp laser center                         = 0,0,0

  # Intensity of the laser
  set mp laser power                          = 0

  # Absorptivity of the liquid part of domain
  set mp liquid absorptivity                  = 0

  # Capacity of the liquid part of domain
  set mp liquid capacity                      = 0

  # Conductivity of the liquid part of domain
  set mp liquid conductivity                  = 0

  # Set the depth of the liquid parts of the melt pool ellipse
  set mp liquid melt pool depth               = 0

  # Set the radius of the liquid parts of the melt pool ellipse  or the width
  # of the parabola
  set mp liquid melt pool radius              = 0

  # Melting point of the liquid part of domain
  set mp liquid melting point                 = 0

  # Maximum temperature arising in the melt pool. If this temperature is lower
  # than the boiling temperature, this value is corrected to correspond to the
  # boiling temperature + 500 K.
  set mp max temperature                      = 0

  # Center coordinates of the melt pool ellipse/parabola. If no value is
  # provided it will be set equally to the laser center
  set mp melt pool center                     = not_initialized

  # Shape of the user defined melt pool
  set mp melt pool shape                      = ellipse

  # Pressure constant for the recoil pressure model.
  set mp recoil pressure constant             = 0

  # Temperature constant for the recoil pressure model.
  set mp recoil pressure temperature constant = 0

  # Scan speed of the laser (in case of an analytical temperature field).
  set mp scan speed                           = 0

  # Definition type of the temperature field: (1) analytical expression (2)
  # solve heat equation (not implemented yet)
  set mp temperature formulation              = analytical

  # This factor scales the analytical temperature field to be anisotropic.
  set mp temperature x to y ratio             = 1
end


subsection normal vector
  # normal vector computation: damping = cell_size *
  # normal_vec_damping_scale_factor
  set normal vec damping scale factor = 0.5

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set normal vec do matrix free       = true       # default: false

  # Defines if the l2norm of the normal vector result should be printed)
  set normal vec do print l2norm      = true

  # Choose the corresponding implementation of the normal vector operation.
  set normal vec implementation       = meltpooldg
end


subsection output
  # this flag enables the computation of the error compared to a given
  # analytical solution.
  set do compute error         = false

  # boolean for computing the phase volumes
  set do compute volume output = false

  # this flag enables the output of wall times (should be disabled if a test
  # file is prepared)
  set do walltime              = false

  # Sets the base name for the volume fraction file output.
  set filename volume output   = my_volumes.txt
end


subsection paraview
  # boolean for writing the initial state into the paraview output file
  set paraview do initial state    = true

  # boolean for producing paraview output files
  set paraview do output           = true     # default: false

  # Sets the base name for the paraview file output.
  set paraview filename            = solution

  # number of digits for the frame number of the vtk-file.
  set paraview n digits timestep   = 4

  # number of parallel written vtk-files.
  set paraview n groups            = 4

  # boolean for writing the computed advection into the paraview output file
  set paraview print advection     = true     # default: false

  # boolean for printing a vtk-file with the boundary id
  set paraview print boundary id   = true     # default: false

  # boolean for writing the computed curvature into the paraview output file
  set paraview print curvature     = false

  # boolean for writing the exact solution into the paraview output file
  set paraview print exactsolution = false

  # boolean for writing the levelset variable into the paraview output file
  set paraview print levelset      = true

  # boolean for writing the computed normalvector into the paraview output
  # file
  set paraview print normal vector = true     # default: false

  # every n timestep that should be written
  set paraview write frequency     = 1
end


subsection reinitialization
  # Defines the length parameter of the level set function to be constant
  # andnot to dependent on the mesh size (default: -1.0 i.e. grid size
  # dependentwhich can be controlled by reinit_epsilon_scale_factor
  set reinit constant epsilon     = -1

  # Set this parameter if a matrix free solution procedure should be
  # performed
  set reinit do matrix free       = true

  # Defines if the l2norm of the reinitialization result should be printed)
  set reinit do print l2norm      = true       # default: false

  # Defines the time step size of the reinitialization to be constant andnot
  # to dependent on the mesh size (default: -1.0 i.e. grid size dependent
  set reinit dtau                 = -1

  # Choose the corresponding implementation of the reinitialization
  # operation.
  set reinit implementation       = meltpooldg

  # Set the maximum number of iterations for solving the linear system of
  # equations.
  set reinit max iterations       = 10000

  # Sets the maximum number of reinitialization steps
  set reinit max n steps          = 5

  # Sets the type of reinitialization model that should be used.
  set reinit modeltype            = olsson2007

  # Set this parameter for choosing a preconditioner type
  set reinit preconditioner type  = Identity

  # Set the relative tolerance for a successful solution of the linear system
  # of equations.
  set reinit rel tolerance rhs    = 1e-08

  # Defines the scaling factor of the diffusion parameter in the
  # reinitialization equation; the scaling factor is multipled by the mesh
  # size (default: 0.5 i.e. eps=0.5*h_min
  set reinit scale factor epsilon = 0.5

  # Set this parameter for choosing a solver type. At the moment GMRES or CG
  # solvers  are supported
  set reinit solver type          = GMRES
end


| normal vector:         i=14 	|n_0| = 150.42493825   |n_1| = 150.43211899   
    | reini: τ= 0.015625  | CG: i=18   	 |ΔΨ|∞ = 0.5939757955    |ΔΨ|²/dT = 209.1852481    |
    | reini: τ= 0.03125   | CG: i=17   	 |ΔΨ|∞ = 0.3215634943    |ΔΨ|²/dT = 105.0330046    |
    | reini: τ= 0.046875  | CG: i=18   	 |ΔΨ|∞ = 0.1567946268    |ΔΨ|²/dT = 50.30687856    |
    | reini: τ= 0.0625    | CG: i=18   	 |ΔΨ|∞ = 0.07701967185   |ΔΨ|²/dT = 24.80684456    |
    | reini: τ= 0.078125  | CG: i=18   	 |ΔΨ|∞ = 0.04089011405   |ΔΨ|²/dT = 13.32116794    |
| normal vector:         i=14 	|n_0| = 117.99083935   |n_1| = 118.0209603    
| curvature:         i=33 	|k| = 1917.130285    
| ls: t= 0.01      | GMRES: i=28   	 |ϕ|2 = 32.23136312    
| normal vector:         i=14 	|n_0| = 118.10366445   |n_1| = 117.94746655   
    | reini: τ= 0.015625  | CG: i=19   	 |ΔΨ|∞ = 0.04305248891   |ΔΨ|²/dT = 10.61197742    |
    | reini: τ= 0.03125   | CG: i=18   	 |ΔΨ|∞ = 0.02972913794   |ΔΨ|²/dT = 7.211422335    |
    | reini: τ= 0.046875  | CG: i=19   	 |ΔΨ|∞ = 0.02246457026   |ΔΨ|²/dT = 5.420599847    |
    | reini: τ= 0.0625    | CG: i=19   	 |ΔΨ|∞ = 0.01851646652   |ΔΨ|²/dT = 4.361856584    |
    | reini: τ= 0.078125  | CG: i=19   	 |ΔΨ|∞ = 0.01565589761   |ΔΨ|²/dT = 3.668264085    |
| normal vector:         i=14 	|n_0| = 117.14335371   |n_1| = 117.02969569   
| curvature:         i=32 	|k| = 1428.7898098   
| ls: t= 0.02      | GMRES: i=27   	 |ϕ|2 = 32.19566249    
| normal vector:         i=14 	|n_0| = 117.46924811   |n_1| = 116.80634216   
    | reini: τ= 0.015625  | CG: i=19   	 |ΔΨ|∞ = 0.02731298625   |ΔΨ|²/dT = 5.99883956     |
    | reini: τ= 0.03125   | CG: i=19   	 |ΔΨ|∞ = 0.01958535773   |ΔΨ|²/dT = 4.478489104    |
    | reini: τ= 0.046875  | CG: i=19   	 |ΔΨ|∞ = 0.01637266545   |ΔΨ|²/dT = 3.596832605    |
    | reini: τ= 0.0625    | CG: i=19   	 |ΔΨ|∞ = 0.01363359077   |ΔΨ|²/dT = 2.996825306    |
    | reini: τ= 0.078125  | CG: i=19   	 |ΔΨ|∞ = 0.01136788284   |ΔΨ|²/dT = 2.549867381    |
| normal vector:         i=14 	|n_0| = 117.37106519   |n_1| = 116.77685004   
| curvature:         i=32 	|k| = 1460.2098802   
| ls: t= 0.03      | GMRES: i=27   	 |ϕ|2 = 32.19059865    
| normal vector:         i=14 	|n_0| = 117.90612806   |n_1| = 116.40493451   
    | reini: τ= 0.015625  | CG: i=19   	 |ΔΨ|∞ = 0.01806593318   |ΔΨ|²/dT = 4.676239265    |
    | reini: τ= 0.03125   | CG: i=19   	 |ΔΨ|∞ = 0.01398305889   |ΔΨ|²/dT = 3.325423164    |
    | reini: τ= 0.046875  | CG: i=19   	 |ΔΨ|∞ = 0.01126156157   |ΔΨ|²/dT = 2.599801875    |
    | reini: τ= 0.0625    | CG: i=19   	 |ΔΨ|∞ = 0.009316369459  |ΔΨ|²/dT = 2.125353414    |
    | reini: τ= 0.078125  | CG: i=19   	 |ΔΨ|∞ = 0.007847276724  |ΔΨ|²/dT = 1.778829913    |
| normal vector:         i=14 	|n_0| = 117.8659417    |n_1| = 116.45560553   
| curvature:         i=32 	|k| = 1468.9147426   
| ls: t= 0.04      | GMRES: i=27   	 |ϕ|2 = 32.18946573    
| normal vector:         i=14 	|n_0| = 118.60483489   |n_1| = 115.93782942   
    | reini: τ= 0.015625  | CG: i=19   	 |ΔΨ|∞ = 0.01519357451   |ΔΨ|²/dT = 3.800526312    |
    | reini: τ= 0.03125   | CG: i=19   	 |ΔΨ|∞ = 0.01093572419   |ΔΨ|²/dT = 2.537590516    |
    | reini: τ= 0.046875  | CG: i=19   	 |ΔΨ|∞ = 0.008708048672  |ΔΨ|²/dT = 1.907250564    |
    | reini: τ= 0.0625    | CG: i=18   	 |ΔΨ|∞ = 0.007226195389  |ΔΨ|²/dT = 1.526268245    |
    | reini: τ= 0.078125  | CG: i=18   	 |ΔΨ|∞ = 0.00606393435   |ΔΨ|²/dT = 1.26320547     |
| normal vector:         i=14 	|n_0| = 118.53370289   |n_1| = 115.97562017   
| curvature:         i=32 	|k| = 1498.8683473   
| ls: t= 0.05      | GMRES: i=27   	 |ϕ|2 = 32.18861212    
| normal vector:         i=14 	|n_0| = 119.46868752   |n_1| = 115.31655756   
    | reini: τ= 0.015625  | CG: i=19   	 |ΔΨ|∞ = 0.01296930023   |ΔΨ|²/dT = 3.356242556    |
    | reini: τ= 0.03125   | CG: i=19   	 |ΔΨ|∞ = 0.009561478695  |ΔΨ|²/dT = 2.074829904    |
    | reini: τ= 0.046875  | CG: i=18   	 |ΔΨ|∞ = 0.00727363823   |ΔΨ|²/dT = 1.485763943    |
    | reini: τ= 0.0625    | CG: i=18   	 |ΔΨ|∞ = 0.005783578357  |ΔΨ|²/dT = 1.163558985    |
    | reini: τ= 0.078125  | CG: i=18   	 |ΔΨ|∞ = 0.004790995003  |ΔΨ|²/dT = 0.9560788929   |
| normal vector:         i=14 	|n_0| = 119.36458228   |n_1| = 115.34054776   
| curvature:         i=32 	|k| = 1557.1981532   
